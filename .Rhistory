return(temp2)
# nodeBased.OUMV <- OUwie(labeledtree, <cleaned.continuous>,model="OUMV", simmap.tree=FALSE, diagn=FALSE)
# return(nodeBased.OUMV)
}
RegimeAssignment(discdatatree = discDataTree, datatree = DataTree)
RegimeAssignment <- function(discdatatree, datatree){
#label tree with best states
reconstruction.info <- ace(discdatatree$data, DataTree$phy, type="discrete", method="ML", CI=TRUE)
best.states <- colnames(reconstruction.info$lik.anc)[apply(reconstruction.info$lik.anc, 1, which.max)]
labeledtree <- datatree$phy
labeledtree$node.label <- best.states
#names <- name_changer(discdatatree$data, "species")
test <- as.data.frame(discdatatree$data)
names<- as.data.frame(tibble::rownames_to_column(test, "SPECIES"))
colnames(names)[2] <- "Species"
regime = as.data.frame(t(test))
temp2 <- data.frame("species"= names[,1], "regime"=regime[,1],
"continuous"=names[,2])
return(temp2)
# nodeBased.OUMV <- OUwie(labeledtree, <cleaned.continuous>,model="OUMV", simmap.tree=FALSE, diagn=FALSE)
# return(nodeBased.OUMV)
}
RegimeAssignment(discdatatree = discDataTree, datatree = DataTree)
RegimeAssignment <- function(discdatatree, datatree){
#label tree with best states
reconstruction.info <- ace(discdatatree$data, DataTree$phy, type="discrete", method="ML", CI=TRUE)
best.states <- colnames(reconstruction.info$lik.anc)[apply(reconstruction.info$lik.anc, 1, which.max)]
labeledtree <- datatree$phy
labeledtree$node.label <- best.states
data <- as.data.frame(discdatatree$data)
names<- as.data.frame(tibble::rownames_to_column(data, "SPECIES"))
colnames(names)[2] <- "Species"
regime = as.data.frame(t(data))
temp2 <- data.frame("species"= names[,1], "regime"=regime[,1],
"continuous"=names[,2])
return(temp2)
}
RegimeAssignment(discdatatree = discDataTree, datatree = DataTree)
source('make.R')
clean()
source('make.R')
source('make.R')
loadd(Contin)
Contin$labeledtree
plot(Contin$labeledtree)
Contin$temp2
Contin$labeledtree
View(Contin)
str(Contin$labeledtree)
source('make.R')
source('make.R')
source('make.R')
source('make.R')
source('make.R')
source('make.R')
loadd(Contin)
Contin$temp2
Contin$labeledtree
source('make.R')
source('make.R')
traceback()
traceback()
source('make.R')
source('make.R')
source('make.R')
source('make.R')
source('make.R')
source('make.R')
source('make.R')
loadd(data_import)
View(data_import)
View(data_import)
source('make.R')
source('make.R')
loadd(data_import)
source('make.R')
loadd(data_import)
View(data_import)
View(data_import)
source('make.R')
source('make.R')
loadd(data_import)
data_import
data_import
source('make.R')
loadd(data_import)
View(data_import)
data_import$diet_binary <- ifelse(unique_data$diet == "insectivore, omnivore" | unique_data$diet == "insectivore, herbivore" |
unique_data$diet == "insectivore, frugivore" | unique_data$diet =="insectivore, carnivore" |
unique_data$diet == "insectivore" | unique_data$diet == "omnivore", 1, 0)
data_import$diet_binary <- ifelse(data_import$diet == "insectivore, omnivore" | data_import$diet == "insectivore, herbivore" |
data_import$diet == "insectivore, frugivore" | data_import$diet =="insectivore, carnivore" |
data_import$diet == "insectivore" | data_import$diet == "omnivore", 1, 0)
data_import
source('make.R')
loadd(data_import)
source('make.R')
loadd(data_import)
source('make.R')
loadd(data_import)
View(data_import)
loadd(data_import)
source('make.R')
loadd(data_import)
View(data_import)
source('make.R')
loadd(data_import)
View(data_import)
loadd(data_import)
source('make.R')
source('make.R')
source('make.R')
source('make.R')
loadd(data_import)
View(data_import)
loadd(data_import)
loadd(data_import)
source('make.R')
loadd(data_import)
View(data_import)
source('make.R')
source('make.R')
source('make.R')
source('make.R')
loadd(data_import)
View(data_import)
source('make.R')
loadd(data_import)
data_import$CleanIm2 %>% inner_join(., data_import$y, by = GenusSpecies)
View(data_import)
data_import$CleanIm2
data_import$y
source('make.R')
source('make.R')
loadd(data_import)
View(data_import)
source('make.R')
source('make.R')
source('make.R')
loadd(DataTree)
DataTree
clean()
source('make.R')
source('make.R')
source('make.R')
source('make.R')
loadd(DataTree)
DataTree$phy
DataTree$data
nrows(DataTree$data)
nrow(DataTree$data)
DataTree$phy
source('make.R')
loadd(DataTree)
View(DataTree)
str(DataTree$data)
loadd(data_import)
View(DataTree)
View(data_import)
source('make.R')
data_import[,BodySize_g]
loadd(data_import)
data_import[,BodySize_g}
data_import[,BodySize_g]
View(data_import)
data_import["BodySize_g"]
source('make.R')
loadd(DataTree)
DataTree
as.numeric(data_import["BodySize_g"])
loadd(data_import)
as.numeric(data_import["BodySize_g"])
as.numeric(as.charactor(data_import["BodySize_g"]))
as.numeric(as.character(data_import["BodySize_g"]))
str(data_import)
as.numeric(as.character(data_import$BodySize_g))
data_import$BodySize_g
clean()
source('make.R')
loadd(DataTree)
DataTree$data
source('make.R')
source('make.R')
loadd(DataTree)
DataTree$data
as.numeric(as.character(DataTree))
as.numeric(as.character(DataTree$data))
clean()
source('make.R')
loadd(DataTree)
DataTree$data
source('make.R')
traceback
traceback()
plan <- drake_plan(
tree_import = GetTreeWithNameProcessing("R/data/consensusTree_10kTrees_Primates_Version3.nex"),
data_import = DataImport(data1 ="R/data/continuous_primate_data.csv",
data2 = "R/data/primate_data.csv",
col1 = "GenusSpecies",
col2 = "diet",
CleanColumn = 10
), # Data of Ape biomass and diet
DataTree = CleanData(tree_import, data_import["BodySize_g"]),
Mods = EvoMod(DataTree), #This has a list of the three modles, the aic output, and weight aic output
#Best = BestMod(Mods),
#CompareTrees = TreeCompare(DataTree, Mods),
#Contin = RegimeAssignment(discdatatree = discDataTree, datatree = DataTree),
#test = OUwie(Contin$labeledtree, Contin$temp2, model="OUMV", simmap.tree=FALSE, diagn=FALSE)
)
Mods = EvoMod(DataTree)
loadd(DataTree)
Mods = EvoMod(DataTree)
clean()
source('make.R')
source('make.R')
loadd(DataTree)
geiger::fitContinuous(DataTree$phy, DataTree$data, model="BM", ncores = 1)
DataTree$data
DataTree$data
source('make.R')
loadd(DataTree)
length(DataTree$phy$tip.label) == nrow(DataTree$data)
DataTree$phy$tip.label
loadd(DataTree)
source('make.R')
source('make.R')
source('make.R')
loadd(Contin)
Contin
source('make.R')
loadd(Contin)
as.data.frame(Contin$data)
Contin$data
Contin$temp2
as.data.frame(Contin$temp2)
str(Contin$temp2)
Contin$labeledtree
Contin$temp2
OUwie(Contin$labeledtree, Contin$temp2, model="OUMV", simmap.tree=FALSE, diagn=FALSE)
datatest = Contin$temp2
datatest
source('make.R')
?base::stop()
source('make.R')
loadd(test)
test
loadd(Contin)
length(Contin$labeledtree$node.label)
nrow(Contin$temp2)
rownames(Contin$temp2)
loadd(DataTree)
DataTree$data
test <- DataTree
test <- DataTree$data
View(test)
DataTree$data[,1]
loadd(discDataTree)
discDataTree$phy$tip.label == DataTree$phy$tip.label
Contin$temp2
Contin$temp2[,1]
Contin$temp2[,1] == Contin$labeledtree$node.label
Contin$temp2[,1]
Contin$labeledtree$node.label
Contin$labeledtree$tip.label
Contin$labeledtree
Contin$temp2
reconstruction.info <- ace(discDataTree$data, DataTree$phy, type="discrete", method="ML", CI=TRUE)
best.states <- colnames(reconstruction.info$lik.anc)[apply(reconstruction.info$lik.anc, 1, which.max)]
best.states
length(best.states)
labeledtree <- datatree$phy
labeledtree <- DataTree$phy
labeledtree$node.label <- best.states
labeledtree$node.label
loadd(import_data)
loadd(data_import)
data_import["BodySize_g"]/1000
source('make.R')
source('make.R')
loadd(test)
test
source('make.R')
source('make.R')
loadd(ouwie_analysis)
ouwie_analysis
models <- c("BM1","BMS","OU1","OUM","OUMV","OUMA","OUMVA")
results <- lapply(models, ouwie_analysis, phy=Contin$labeledtree, data=Contin$temp2)
results <- lapply(models, OUwie, phy=Contin$labeledtree, data=Contin$temp2)
loadd(Contin)
models <- c("BM1","BMS","OU1","OUM","OUMV","OUMA","OUMVA")
results <- lapply(models, OUwie, phy=Contin$labeledtree, data=Contin$temp2)
results
AICc.values<-sapply(results, "[[", "AICc")
names(AICc.values)<-models
AICc.values<-AICc.values-min(AICc.values)
print(AICc.values) #The best model is the one with smallest AICc score
best<-results[[which.min(AICc.values)]] #store for later
print(best) #prints info on best model
loadd(Contin)
models <- c("BM1","BMS","OU1","OUM","OUMV","OUMA","OUMVA")
AllOuwie <- function(phy, model, data){
}
}
}
AllOuwie <- function(phy, model, data){
)
AllOuwie <- function(phy, model, data){
results <- lapply(model, OUwie, phy, data)
AICc.values<-sapply(results, "[[", "AICc")
names(AICc.values)<-models
AICc.values<-AICc.values-min(AICc.values)
best<-results[[which.min(AICc.values)]] #store for later
return(list("AIC values" = AICc.values, "Best Model" = best)) #prints info on best model
}
AllOuwie(phy = Contin$labeledtree, model = models, data = Contin$temp2)
models <- c("BM1","BMS","OU1","OUM","OUMV","OUMA","OUMVA")
AllOuwie <- function(phy, model, data){
results <- lapply(model, OUwie, phy, data)
AICc.values<-sapply(results, "[[", "AICc")
names(AICc.values)<-models
AICc.values<-AICc.values-min(AICc.values)
best<-results[[which.min(AICc.values)]] #store for later
return(list("AIC values" = AICc.values, "Best Model" = best)) #prints info on best model
}
AllOuwie(phy = Contin$labeledtree, model = models, data = Contin$temp2)
loadd(Contin)
models <- c("BM1","BMS","OU1","OUM","OUMV","OUMA","OUMVA")
results <- lapply(models, OUwie, phy=Contin$labeledtree, data=Contin$temp2)
models <- c("BM1","BMS","OU1","OUM","OUMV","OUMA","OUMVA")
AllOuwie <- function(phy, model, data){
results <- lapply(model, OUwie, phy = phy, data = data)
AICc.values<-sapply(results, "[[", "AICc")
names(AICc.values)<-models
AICc.values<-AICc.values-min(AICc.values)
best<-results[[which.min(AICc.values)]] #store for later
return(list("AIC values" = AICc.values, "Best Model" = best)) #prints info on best model
}
AllOuwie(phy = Contin$labeledtree, model = models, data = Contin$temp2)
source('make.R')
clean()
make()
make('plan.R')
source('make.R')
clean()
source('make.R')
source('make.R')
loadd(Contin)
loadd(Contin)
alpha.values<-seq(from= 0.001 , to= 5 , length.out=50)
likelihood.values <- rep(NA, length(alpha.values))
for (iteration in sequence(length(alpha.values))) {
likelihood.values[iteration] <- OUwie.fixed(Contin$labeledtree, Contin$temp2, model="OUMV", alpha=rep(alpha.values[iteration],2), sigma.sq=best$solution[2,], theta=best$theta[,1])$loglik
}
loadd(Contin)
alpha.values<-seq(from= 0.001 , to= 1 , length.out=50)
likelihood.values <- rep(NA, length(alpha.values))
for (iteration in sequence(length(alpha.values))) {
likelihood.values[iteration] <- OUwie.fixed(Contin$labeledtree, Contin$temp2, model="OUMV", alpha=rep(alpha.values[iteration],2), sigma.sq=best$solution[2,], theta=best$theta[,1])$loglik
}
traceback
traceback()
OUwie.fixed
?%*%
loadd(Contin)
alpha.values<-seq(from= 0.001 , to= 1 , length.out=50)
likelihood.values
alpha.values
alpha.values<-seq(from= 0.001 , to= 1 , length.out=50)
likelihood.values
?OUwie.fixed
alpha=rep(alpha.values[iteration],2)
alpha
sigma.sq=best$solution[2,]
sigma.sq
theta=best$theta[,1])$loglik
theta=best$theta[,1])
theta=best$theta[,1]
theta
best$theta
OUwie.fixed(Contin$labeledtree, Contin$temp2, model="OUMV", alpha=rep(alpha.values[iteration],2), sigma.sq=best$solution[2,], theta=best$theta[,1])$loglik
OUwie.fixed(Contin$labeledtree, Contin$temp2, model="OUMV", alpha=rep(alpha.values[iteration],2), sigma.sq=best$solution[2,], theta=best$theta[,1])
likelihood.values <- rep(1, length(alpha.values))
likelihood.values
alpha.values<-seq(from= 0.0000001 , to= 2 , length.out=50)
likelihood.values <- rep(NA, length(alpha.values))
likelihood.values
likelihood.values <- rep(5, length(alpha.values))
likelihood.values
likelihood.values <- rep(1, length(alpha.values))
for (iteration in sequence(length(alpha.values))) {
likelihood.values[iteration] <- OUwie.fixed(Contin$labeledtree, Contin$temp2, model="OUMV", alpha=rep(alpha.values[iteration],2), sigma.sq=best$solution[2,], theta=best$theta[,1])$loglik
}
best$theta[,1]
likelihood.values <- rep(1, length(alpha.values))
for (iteration in sequence(length(alpha.values))) {
likelihood.values[iteration] <- OUwie.fixed(Contin$labeledtree, Contin$temp2, model="OUMV", alpha=rep(alpha.values[iteration],2), sigma.sq=best$solution[2,])$loglik
}
source('make.R')
source('make.R')
source('make.R')
source('make.R')
source('make.R')
source('make.R')
loadd(Contin)
alpha.values<-seq(from= 0.0000001 , to= 2 , length.out=50)
likelihood.values <- rep(1, length(alpha.values))
for (iteration in sequence(length(alpha.values))) {
likelihood.values[iteration] <- OUwie.fixed(Contin$labeledtree, Contin$temp2, model="OUMV", alpha=rep(alpha.values[iteration],2), sigma.sq=best$solution[2,], theta=best$theta[1,2])$loglik
}
loadd(Contin)
alpha.values<-seq(from= 0.0000001 , to= 2 , length.out=50)
likelihood.values <- rep(1, length(alpha.values))
for (iteration in sequence(length(alpha.values))) {
likelihood.values[iteration] <- OUwie.fixed(Contin$labeledtree, Contin$temp2, model="OUMV", alpha=rep(alpha.values[iteration],2), sigma.sq=best$solution[2,], theta=best$theta[1,1])$loglik
}
loadd(ouwie_analysis)
source("make.R")
source("make.R")
loadd(FullOuwieAnalysis)
FullOuwieAnalysis$best$model
loadd(Contin)
loadd(Contin)
alpha.values<-seq(from= 0.0000001 , to= 2 , length.out=50)
likelihood.values <- rep(1, length(alpha.values))
for (iteration in sequence(length(alpha.values))) {
likelihood.values[iteration] <- OUwie.fixed(Contin$labeledtree, Contin$temp2,
model = FullOuwieAnalysis$best$model,
alpha=alpha.values,
sigma.sq=best$solution[2,], theta=best$theta[1,1])$loglik
}
FullOuwieAnalysis$best
loadd(Contin)
alpha.values<-seq(from= 0.0000001 , to= 2 , length.out=50)
likelihood.values <- rep(1, length(alpha.values))
for (iteration in sequence(length(alpha.values))) {
loadd(Contin)
alpha.values<-seq(from= 0.0000001 , to= 2 , length.out=50)
likelihood.values <- rep(1, length(alpha.values))
)
loadd(Contin)
alpha.values<-seq(from= 0.0000001 , to= 2 , length.out=50)
likelihood.values <- rep(1, length(alpha.values))
for (iteration in sequence(length(alpha.values))) {
likelihood.values[iteration] <- OUwie.fixed(Contin$labeledtree, Contin$temp2,
model = FullOuwieAnalysis$best$model,
alpha=alpha.values,
sigma.sq=best$solution[2,], FullOuwieAnalysis$best)
}
mass_likelihood(labeled.tree, ouwie_continuous,
best$model, alpha.values,
likelihood.values, best),
FullOuwieAnalysis$best$model
FullOuwieAnalysis$best$solution
FullOuwieAnalysis$best$solution[,2]
FullOuwieAnalysis$best$theta
FullOuwieAnalysis$best$theta[,1]
rep(alpha.values[iteration],2)
loadd(Contin)
alpha.values<-seq(from= 0.0000001 , to= 2 , length.out=50)
likelihood.values <- rep(1, length(alpha.values))
for (iteration in sequence(length(alpha.values))) {
likelihood.values[iteration] <- OUwie.fixed(Contin$labeledtree, Contin$temp2,
model = FullOuwieAnalysis$best$model,
alpha=rep(alpha.values[iteration],2),
sigma.sq=FullOuwieAnalysis$best$solution[,2], FullOuwieAnalysis$best$theta[,1])$loglik
}
FullOuwieAnalysis$best$model
loadd(Contin)
alpha.values<-seq(from= 0.0000001 , to= 2 , length.out=50)
likelihood.values <- rep(1, length(alpha.values))
for (iteration in sequence(length(alpha.values))) {
likelihood.values[iteration] <- OUwie.fixed(Contin$labeledtree, Contin$temp2,
model = "OUMV",
alpha=rep(alpha.values[iteration],2),
sigma.sq=FullOuwieAnalysis$best$solution[,2],
FullOuwieAnalysis$best$theta[,1])$loglik
}
loadd(Contin)
alpha.values<-seq(from= 0.0000001 , to= 2 , length.out=50)
likelihood.values <- rep(1, length(alpha.values))
for (iteration in sequence(length(alpha.values))) {
likelihood.values[iteration] <- OUwie.fixed(Contin$labeledtree, Contin$temp2$continuous,
model = FullOuwieAnalysis$best$model,
alpha=rep(alpha.values[iteration],2),
sigma.sq=FullOuwieAnalysis$best$solution[,2],
FullOuwieAnalysis$best$theta[,1])$loglik
}
Contin$temp2
loadd(Contin)
alpha.values<-seq(from= 0.0000001 , to= 2 , length.out=50)
likelihood.values <- rep(NA, length(alpha.values))
for (iteration in sequence(length(alpha.values))) {
likelihood.values[iteration] <- OUwie.fixed(Contin$labeledtree, Contin$temp2,
model = FullOuwieAnalysis$best$model,
alpha=rep(alpha.values[iteration],2),
sigma.sq=FullOuwieAnalysis$best$solution[,2],
FullOuwieAnalysis$best$theta[,1])$loglik
}
OUwie.fixed(Contin$labeledtree, Contin$temp2,
model = FullOuwieAnalysis$best$model,
alpha=rep(alpha.values[iteration],2),
sigma.sq=FullOuwieAnalysis$best$solution[,2],
FullOuwieAnalysis$best$theta[,1])$loglik
likelihood.values <- rep(NA, length(alpha.values))
for (iteration in sequence(length(alpha.values))) {
likelihood.values[iteration] <- OUwie.fixed(Contin$labeledtree, Contin$temp2,
model = FullOuwieAnalysis$best$model,
alpha=rep(alpha.values[iteration],2),
sigma.sq=FullOuwieAnalysis$best$solution[,2],
FullOuwieAnalysis$best$theta[,1])
}
$loglik
